var mt={},St={};Object.defineProperty(St,"__esModule",{value:!0});var Ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ct=function(){function e(t,i){for(var n=0;n<i.length;n++){var r=i[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();function Ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var X=100,Ht="…",K={tag:function(t,i){var n=document.createElement(t);return n.className=i,n},text:function(t){return document.createTextNode(t)}},st=function(){ct(e,null,[{key:"hexDigits",get:function(){return"0123456789ABCDEF"}},{key:"reTime",get:function(){return/^((?:1[89]|2\d)?\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/}}]);function e(t,i){Ft(this,e),t instanceof e?(this.enc=t.enc,this.pos=t.pos):(this.enc=t,this.pos=i)}return ct(e,[{key:"get",value:function(i){if(i===void 0&&(i=this.pos++),i>=this.enc.length)throw"Requesting byte offset "+i+" on a stream of length "+this.enc.length;return this.enc[i]}},{key:"hexByte",value:function(i){return e.hexDigits.charAt(i>>4&15)+e.hexDigits.charAt(i&15)}},{key:"hexDump",value:function(i,n,r){for(var o="",f=i;f<n;++f)if(o+=this.hexByte(this.get(f)),r!==!0)switch(f&15){case 7:o+="  ";break;case 15:o+=`
`;break;default:o+=" "}return o}},{key:"parseStringISO",value:function(i,n){for(var r="",o=i;o<n;++o)r+=String.fromCharCode(this.get(o));return r}},{key:"parseStringUTF",value:function(i,n){for(var r="",o=i;o<n;){var f=this.get(o++);f<128?r+=String.fromCharCode(f):f>191&&f<224?r+=String.fromCharCode((f&31)<<6|this.get(o++)&63):r+=String.fromCharCode((f&15)<<12|(this.get(o++)&63)<<6|this.get(o++)&63)}return r}},{key:"parseStringBMP",value:function(i,n){for(var r="",o=i;o<n;o+=2){var f=this.get(o),a=this.get(o+1);r+=String.fromCharCode((f<<8)+a)}return r}},{key:"parseTime",value:function(i,n){var r=this.parseStringISO(i,n),o=e.reTime.exec(r);return o?(r=o[1]+"-"+o[2]+"-"+o[3]+" "+o[4],o[5]&&(r+=":"+o[5],o[6]&&(r+=":"+o[6],o[7]&&(r+="."+o[7]))),o[8]&&(r+=" UTC",o[8]!="Z"&&(r+=o[8],o[9]&&(r+=":"+o[9]))),r):"Unrecognized time: "+r}},{key:"parseInteger",value:function(i,n){var r=n-i;if(r>4){r<<=3;var o=this.get(i);if(o===0)r-=8;else for(;o<128;)o<<=1,--r;return"("+r+" bit)"}for(var f=0,a=i;a<n;++a)f=f<<8|this.get(a);return f}},{key:"parseBitString",value:function(i,n){var r=this.get(i),o=(n-i-1<<3)-r,f="("+o+" bit)";if(o<=20){var a=r;f+=" ";for(var v=n-1;v>i;--v){for(var m=this.get(v),g=a;g<8;++g)f+=m>>g&1?"1":"0";a=0}}return f}},{key:"parseOctetString",value:function(i,n){var r=n-i,o="("+r+" byte) ";r>X&&(n=i+X);for(var f=i;f<n;++f)o+=this.hexByte(this.get(f));return r>X&&(o+=Ht),o}},{key:"parseOID",value:function(i,n){for(var r="",o=0,f=0,a=i;a<n;++a){var v=this.get(a);if(o=o<<7|v&127,f+=7,!(v&128)){if(r===""){var m=o<80?o<40?0:1:2;r=m+"."+(o-m*40)}else r+="."+(f>=31?"bigint":o);o=f=0}}return r}}]),e}(),_=St.ASN1=function(){ct(e,null,[{key:"reSeemsASCII",get:function(){return/^[ -~]+$/}}]);function e(t,i,n,r,o){Ft(this,e),this.stream=t,this.header=i,this.length=n,this.tag=r,this.sub=o}return ct(e,[{key:"typeName",value:function(){if(this.tag===void 0)return"unknown";var i=this.tag>>6;this.tag>>5&1;var n=this.tag&31;switch(i){case 0:switch(n){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString";default:return"Universal_"+n.toString(16)}case 1:return"Application_"+n.toString(16);case 2:return"["+n+"]";case 3:return"Private_"+n.toString(16)}}},{key:"content",value:function(){if(this.tag===void 0)return null;var i=this.tag>>6,n=this.tag&31,r=this.posContent(),o=Math.abs(this.length);if(i!==0){if(this.sub!==null)return"("+this.sub.length+" elem)";var f=this.stream.parseStringISO(r,r+Math.min(o,X));return e.reSeemsASCII.test(f)?f.substring(0,2*X)+(f.length>2*X?Ht:""):this.stream.parseOctetString(r,r+o)}switch(n){case 1:return this.stream.get(r)===0?"false":"true";case 2:return this.stream.parseInteger(r,r+o);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(r,r+o);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(r,r+o);case 6:return this.stream.parseOID(r,r+o);case 16:case 17:return"("+this.sub.length+" elem)";case 12:return this.stream.parseStringUTF(r,r+o);case 18:case 19:case 20:case 21:case 22:case 26:return this.stream.parseStringISO(r,r+o);case 30:return this.stream.parseStringBMP(r,r+o);case 23:case 24:return this.stream.parseTime(r,r+o)}return null}},{key:"toString",value:function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"}},{key:"print",value:function(i){if(i===void 0&&(i=""),document.writeln(i+this),this.sub!==null){i+="  ";for(var n=0,r=this.sub.length;n<r;++n)this.sub[n].print(i)}}},{key:"toPrettyString",value:function(i){i===void 0&&(i="");var n=i+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(n+="+"),n+=this.length,this.tag&32?n+=" (constructed)":(this.tag==3||this.tag==4)&&this.sub!==null&&(n+=" (encapsulates)"),n+=`
`,this.sub!==null){i+="  ";for(var r=0,o=this.sub.length;r<o;++r)n+=this.sub[r].toPrettyString(i)}return n}},{key:"toDOM",value:function(){var i=K.tag("div","node");i.asn1=this;var n=K.tag("div","head"),r=this.typeName().replace(/_/g," ");n.innerHTML=r;var o=this.content();if(o!==null){o=String(o).replace(/</g,"&lt;");var f=K.tag("span","preview");f.appendChild(K.text(o)),n.appendChild(f)}i.appendChild(n),this.node=i,this.head=n;var a=K.tag("div","value");if(r="Offset: "+this.stream.pos+"<br/>",r+="Length: "+this.header+"+",this.length>=0?r+=this.length:r+=-this.length+" (undefined)",this.tag&32?r+="<br/>(constructed)":(this.tag==3||this.tag==4)&&this.sub!==null&&(r+="<br/>(encapsulates)"),o!==null&&(r+="<br/>Value:<br/><b>"+o+"</b>",(typeof oids>"u"?"undefined":Ke(oids))==="object"&&this.tag==6)){var v=oids[o];v&&(v.d&&(r+="<br/>"+v.d),v.c&&(r+="<br/>"+v.c),v.w&&(r+="<br/>(warning!)"))}a.innerHTML=r,i.appendChild(a);var m=K.tag("div","sub");if(this.sub!==null)for(var g=0,T=this.sub.length;g<T;++g)m.appendChild(this.sub[g].toDOM());return i.appendChild(m),n.onclick=function(){i.className=i.className=="node collapsed"?"node":"node collapsed"},i}},{key:"posStart",value:function(){return this.stream.pos}},{key:"posContent",value:function(){return this.stream.pos+this.header}},{key:"posEnd",value:function(){return this.stream.pos+this.header+Math.abs(this.length)}},{key:"fakeHover",value:function(i){this.node.className+=" hover",i&&(this.head.className+=" hover")}},{key:"fakeOut",value:function(i){var n=/ ?hover/;this.node.className=this.node.className.replace(n,""),i&&(this.head.className=this.head.className.replace(n,""))}},{key:"toHexDOM_sub",value:function(i,n,r,o,f){if(!(o>=f)){var a=K.tag("span",n);a.appendChild(K.text(r.hexDump(o,f))),i.appendChild(a)}}},{key:"toHexDOM",value:function(i){var n=K.tag("span","hex");if(i===void 0&&(i=n),this.head.hexNode=n,this.head.onmouseover=function(){this.hexNode.className="hexCurrent"},this.head.onmouseout=function(){this.hexNode.className="hex"},n.asn1=this,n.onmouseover=function(){var v=!i.selected;v&&(i.selected=this.asn1,this.className="hexCurrent"),this.asn1.fakeHover(v)},n.onmouseout=function(){var v=i.selected==this.asn1;this.asn1.fakeOut(v),v&&(i.selected=null,this.className="hex")},this.toHexDOM_sub(n,"tag",this.stream,this.posStart(),this.posStart()+1),this.toHexDOM_sub(n,this.length>=0?"dlen":"ulen",this.stream,this.posStart()+1,this.posContent()),this.sub===null)n.appendChild(K.text(this.stream.hexDump(this.posContent(),this.posEnd())));else if(this.sub.length>0){var r=this.sub[0],o=this.sub[this.sub.length-1];this.toHexDOM_sub(n,"intro",this.stream,this.posContent(),r.posStart());for(var f=0,a=this.sub.length;f<a;++f)n.appendChild(this.sub[f].toHexDOM(i));this.toHexDOM_sub(n,"outro",this.stream,o.posEnd(),this.posEnd())}return n}},{key:"toHexString",value:function(i){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)}}]),e}();_.decodeLength=function(e){var t=e.get(),i=t&127;if(i==t)return i;if(i>3)throw"Length over 24 bits not supported at position "+(e.pos-1);if(i===0)return-1;t=0;for(var n=0;n<i;++n)t=t<<8|e.get();return t};_.hasContent=function(e,t,i){if(e&32)return!0;if(e<3||e>4)return!1;var n=new st(i);e==3&&n.get();var r=n.get();if(r>>6&1)return!1;try{var o=_.decodeLength(n);return n.pos-i.pos+o==t}catch{return!1}};_.decode=function(e){e instanceof st||(e=new st(e,0));var t=new st(e),i=e.get(),n=_.decodeLength(e),r=e.pos-t.pos,o=null;if(_.hasContent(i,n,e)){var f=e.pos;if(i==3&&e.get(),o=[],n>=0){for(var a=f+n;e.pos<a;)o[o.length]=_.decode(e);if(e.pos!=a)throw"Content size is not correct for container starting at offset "+f}else try{for(;;){var v=_.decode(e);if(v.tag===0)break;o[o.length]=v}n=f-e.pos}catch(m){throw"Exception while decoding undefined length content: "+m}}else e.pos+=n;return new _(t,r,n,i,o)};_.test=function(){for(var e=[{value:[39],expected:39},{value:[129,201],expected:201},{value:[131,254,220,186],expected:16702650}],t=0,i=e.length;t<i;++t){var n=new st(e[t].value,0),r=_.decodeLength(n);r!=e[t].expected&&document.write("In test["+t+"] expected "+e[t].expected+" got "+r+`
`)}};var Lt={},W={},Tt={},M={};Object.defineProperty(M,"__esModule",{value:!0});M.nbi=C;M.int2char=yt;M.intAt=qt;M.nbv=Dt;M.nbits=dt;function Bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Q,y=M.BigInteger=function e(t,i,n){Bt(this,e),t!=null&&(typeof t=="number"?this.fromNumber(t,i,n):i==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,i))};function C(){return new y(null)}function Fe(e,t,i,n,r,o){for(var f=t&16383,a=t>>14;--o>=0;){var v=this[e]&16383,m=this[e++]>>14,g=a*v+m*f;v=f*v+((g&16383)<<14)+i[n]+r,r=(v>>28)+(g>>14)+a*m,i[n++]=v&268435455}return r}y.prototype.am=Fe,Q=28;y.prototype.DB=Q;y.prototype.DM=(1<<Q)-1;y.prototype.DV=1<<Q;var xt=52;y.prototype.FV=Math.pow(2,xt);y.prototype.F1=xt-Q;y.prototype.F2=2*Q-xt;var He="0123456789abcdefghijklmnopqrstuvwxyz",gt=[],tt,O;tt="0".charCodeAt(0);for(O=0;O<=9;++O)gt[tt++]=O;tt="a".charCodeAt(0);for(O=10;O<36;++O)gt[tt++]=O;tt="A".charCodeAt(0);for(O=10;O<36;++O)gt[tt++]=O;function yt(e){return He.charAt(e)}function qt(e,t){var i=gt[e.charCodeAt(t)];return i??-1}function Le(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function qe(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function Dt(e){var t=C();return t.fromInt(e),t}function Ue(e,t){var i;if(t==16)i=4;else if(t==8)i=3;else if(t==256)i=8;else if(t==2)i=1;else if(t==32)i=5;else if(t==4)i=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,r=!1,o=0;--n>=0;){var f=i==8?e[n]&255:qt(e,n);if(f<0){e.charAt(n)=="-"&&(r=!0);continue}r=!1,o==0?this[this.t++]=f:o+i>this.DB?(this[this.t-1]|=(f&(1<<this.DB-o)-1)<<o,this[this.t++]=f>>this.DB-o):this[this.t-1]|=f<<o,o+=i,o>=this.DB&&(o-=this.DB)}i==8&&e[0]&128&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),r&&y.ZERO.subTo(this,this)}function je(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function Je(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var i=(1<<t)-1,n,r=!1,o="",f=this.t,a=this.DB-f*this.DB%t;if(f-- >0)for(a<this.DB&&(n=this[f]>>a)>0&&(r=!0,o=yt(n));f>=0;)a<t?(n=(this[f]&(1<<a)-1)<<t-a,n|=this[--f]>>(a+=this.DB-t)):(n=this[f]>>(a-=t)&i,a<=0&&(a+=this.DB,--f)),n>0&&(r=!0),r&&(o+=yt(n));return r?o:"0"}function ze(){var e=C();return y.ZERO.subTo(this,e),e}function Ge(){return this.s<0?this.negate():this}function Ze(e){var t=this.s-e.s;if(t!=0)return t;var i=this.t;if(t=i-e.t,t!=0)return this.s<0?-t:t;for(;--i>=0;)if((t=this[i]-e[i])!=0)return t;return 0}function dt(e){var t=1,i;return(i=e>>>16)!=0&&(e=i,t+=16),(i=e>>8)!=0&&(e=i,t+=8),(i=e>>4)!=0&&(e=i,t+=4),(i=e>>2)!=0&&(e=i,t+=2),(i=e>>1)!=0&&(e=i,t+=1),t}function $e(){return this.t<=0?0:this.DB*(this.t-1)+dt(this[this.t-1]^this.s&this.DM)}function Xe(e,t){var i;for(i=this.t-1;i>=0;--i)t[i+e]=this[i];for(i=e-1;i>=0;--i)t[i]=0;t.t=this.t+e,t.s=this.s}function Ye(e,t){for(var i=e;i<this.t;++i)t[i-e]=this[i];t.t=Math.max(this.t-e,0),t.s=this.s}function We(e,t){var i=e%this.DB,n=this.DB-i,r=(1<<n)-1,o=Math.floor(e/this.DB),f=this.s<<i&this.DM,a;for(a=this.t-1;a>=0;--a)t[a+o+1]=this[a]>>n|f,f=(this[a]&r)<<i;for(a=o-1;a>=0;--a)t[a]=0;t[o]=f,t.t=this.t+o+1,t.s=this.s,t.clamp()}function Qe(e,t){t.s=this.s;var i=Math.floor(e/this.DB);if(i>=this.t){t.t=0;return}var n=e%this.DB,r=this.DB-n,o=(1<<n)-1;t[0]=this[i]>>n;for(var f=i+1;f<this.t;++f)t[f-i-1]|=(this[f]&o)<<r,t[f-i]=this[f]>>n;n>0&&(t[this.t-i-1]|=(this.s&o)<<r),t.t=this.t-i,t.clamp()}function ti(e,t){for(var i=0,n=0,r=Math.min(e.t,this.t);i<r;)n+=this[i]-e[i],t[i++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;i<this.t;)n+=this[i],t[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<e.t;)n-=e[i],t[i++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[i++]=this.DV+n:n>0&&(t[i++]=n),t.t=i,t.clamp()}function ei(e,t){var i=this.abs(),n=e.abs(),r=i.t;for(t.t=r+n.t;--r>=0;)t[r]=0;for(r=0;r<n.t;++r)t[r+i.t]=i.am(0,n[r],t,r,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&y.ZERO.subTo(t,t)}function ii(e){for(var t=this.abs(),i=e.t=2*t.t;--i>=0;)e[i]=0;for(i=0;i<t.t-1;++i){var n=t.am(i,t[i],e,2*i,0,1);(e[i+t.t]+=t.am(i+1,2*t[i],e,2*i+1,n,t.t-i-1))>=t.DV&&(e[i+t.t]-=t.DV,e[i+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(i,t[i],e,2*i,0,1)),e.s=0,e.clamp()}function ni(e,t,i){var n=e.abs();if(!(n.t<=0)){var r=this.abs();if(r.t<n.t){t?.fromInt(0),i!=null&&this.copyTo(i);return}i==null&&(i=C());var o=C(),f=this.s,a=e.s,v=this.DB-dt(n[n.t-1]);v>0?(n.lShiftTo(v,o),r.lShiftTo(v,i)):(n.copyTo(o),r.copyTo(i));var m=o.t,g=o[m-1];if(g!=0){var T=g*(1<<this.F1)+(m>1?o[m-2]>>this.F2:0),B=this.FV/T,D=(1<<this.F1)/T,R=1<<this.F2,w=i.t,P=w-m,I=t??C();for(o.dlShiftTo(P,I),i.compareTo(I)>=0&&(i[i.t++]=1,i.subTo(I,i)),y.ONE.dlShiftTo(m,I),I.subTo(o,o);o.t<m;)o[o.t++]=0;for(;--P>=0;){var N=i[--w]==g?this.DM:Math.floor(i[w]*B+(i[w-1]+R)*D);if((i[w]+=o.am(0,N,i,P,0,m))<N)for(o.dlShiftTo(P,I),i.subTo(I,i);i[w]<--N;)i.subTo(I,i)}t!=null&&(i.drShiftTo(m,t),f!=a&&y.ZERO.subTo(t,t)),i.t=m,i.clamp(),v>0&&i.rShiftTo(v,i),f<0&&y.ZERO.subTo(i,i)}}}function ri(e){var t=C();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(y.ZERO)>0&&e.subTo(t,t),t}var et=M.Classic=function e(t){Bt(this,e),this.m=t};function si(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function oi(e){return e}function hi(e){e.divRemTo(this.m,null,e)}function ai(e,t,i){e.multiplyTo(t,i),this.reduce(i)}function ui(e,t){e.squareTo(t),this.reduce(t)}et.prototype.convert=si;et.prototype.revert=oi;et.prototype.reduce=hi;et.prototype.mulTo=ai;et.prototype.sqrTo=ui;function fi(){if(this.t<1)return 0;var e=this[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}var it=M.Montgomery=function e(t){Bt(this,e),this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t};function li(e){var t=C();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(y.ZERO)>0&&this.m.subTo(t,t),t}function ci(e){var t=C();return e.copyTo(t),this.reduce(t),t}function pi(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var i=e[t]&32767,n=i*this.mpl+((i*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(i=t+this.m.t,e[i]+=this.m.am(0,n,e,t,0,this.m.t);e[i]>=e.DV;)e[i]-=e.DV,e[++i]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function gi(e,t){e.squareTo(t),this.reduce(t)}function di(e,t,i){e.multiplyTo(t,i),this.reduce(i)}it.prototype.convert=li;it.prototype.revert=ci;it.prototype.reduce=pi;it.prototype.mulTo=di;it.prototype.sqrTo=gi;function vi(){return(this.t>0?this[0]&1:this.s)==0}function yi(e,t){if(e>4294967295||e<1)return y.ONE;var i=C(),n=C(),r=t.convert(this),o=dt(e)-1;for(r.copyTo(i);--o>=0;)if(t.sqrTo(i,n),(e&1<<o)>0)t.mulTo(n,r,i);else{var f=i;i=n,n=f}return t.revert(i)}function bi(e,t){var i;return e<256||t.isEven()?i=new et(t):i=new it(t),this.exp(e,i)}y.prototype.copyTo=Le;y.prototype.fromInt=qe;y.prototype.fromString=Ue;y.prototype.clamp=je;y.prototype.dlShiftTo=Xe;y.prototype.drShiftTo=Ye;y.prototype.lShiftTo=We;y.prototype.rShiftTo=Qe;y.prototype.subTo=ti;y.prototype.multiplyTo=ei;y.prototype.squareTo=ii;y.prototype.divRemTo=ni;y.prototype.invDigit=fi;y.prototype.isEven=vi;y.prototype.exp=yi;y.prototype.toString=Je;y.prototype.negate=ze;y.prototype.abs=Ge;y.prototype.compareTo=Ze;y.prototype.bitLength=$e;y.prototype.mod=ri;y.prototype.modPowInt=bi;y.ZERO=Dt(0);y.ONE=Dt(1);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.BigInteger=void 0;var t=M;Object.defineProperty(e,"BigInteger",{enumerable:!0,get:function(){return t.BigInteger}});function i(){var s=(0,t.nbi)();return this.copyTo(s),s}function n(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function r(){return this.t==0?this.s:this[0]<<24>>24}function o(){return this.t==0?this.s:this[0]<<16>>16}function f(s){return Math.floor(Math.LN2*this.DB/Math.log(s))}function a(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1}function v(s){if(s==null&&(s=10),this.signum()==0||s<2||s>36)return"0";var h=this.chunkSize(s),u=Math.pow(s,h),l=(0,t.nbv)(u),p=(0,t.nbi)(),d=(0,t.nbi)(),S="";for(this.divRemTo(l,p,d);p.signum()>0;)S=(u+d.intValue()).toString(s).substr(1)+S,p.divRemTo(l,p,d);return d.intValue().toString(s)+S}function m(s,h){this.fromInt(0),h==null&&(h=10);for(var u=this.chunkSize(h),l=Math.pow(h,u),p=!1,d=0,S=0,b=0;b<s.length;++b){var U=(0,t.intAt)(s,b);if(U<0){s.charAt(b)=="-"&&this.signum()==0&&(p=!0);continue}S=h*S+U,++d>=u&&(this.dMultiply(l),this.dAddOffset(S,0),d=0,S=0)}d>0&&(this.dMultiply(Math.pow(h,d)),this.dAddOffset(S,0)),p&&t.BigInteger.ZERO.subTo(this,this)}function g(s,h,u){if(typeof h=="number")if(s<2)this.fromInt(1);else for(this.fromNumber(s,u),this.testBit(s-1)||this.bitwiseTo(t.BigInteger.ONE.shiftLeft(s-1),N,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(h);)this.dAddOffset(2,0),this.bitLength()>s&&this.subTo(t.BigInteger.ONE.shiftLeft(s-1),this);else{var l=[],p=s&7;l.length=(s>>3)+1,h.nextBytes(l),p>0?l[0]&=(1<<p)-1:l[0]=0,this.fromString(l,256)}}function T(){var s=this.t,h=[];h[0]=this.s;var u=this.DB-s*this.DB%8,l,p=0;if(s-- >0)for(u<this.DB&&(l=this[s]>>u)!=(this.s&this.DM)>>u&&(h[p++]=l|this.s<<this.DB-u);s>=0;)u<8?(l=(this[s]&(1<<u)-1)<<8-u,l|=this[--s]>>(u+=this.DB-8)):(l=this[s]>>(u-=8)&255,u<=0&&(u+=this.DB,--s)),l&128&&(l|=-256),p==0&&(this.s&128)!=(l&128)&&++p,(p>0||l!=this.s)&&(h[p++]=l);return h}function B(s){return this.compareTo(s)==0}function D(s){return this.compareTo(s)<0?this:s}function R(s){return this.compareTo(s)>0?this:s}function w(s,h,u){var l,p,d=Math.min(s.t,this.t);for(l=0;l<d;++l)u[l]=h(this[l],s[l]);if(s.t<this.t){for(p=s.s&this.DM,l=d;l<this.t;++l)u[l]=h(this[l],p);u.t=this.t}else{for(p=this.s&this.DM,l=d;l<s.t;++l)u[l]=h(p,s[l]);u.t=s.t}u.s=h(this.s,s.s),u.clamp()}function P(s,h){return s&h}function I(s){var h=(0,t.nbi)();return this.bitwiseTo(s,P,h),h}function N(s,h){return s|h}function Xt(s){var h=(0,t.nbi)();return this.bitwiseTo(s,N,h),h}function Ot(s,h){return s^h}function Yt(s){var h=(0,t.nbi)();return this.bitwiseTo(s,Ot,h),h}function Mt(s,h){return s&~h}function Wt(s){var h=(0,t.nbi)();return this.bitwiseTo(s,Mt,h),h}function Qt(){for(var s=(0,t.nbi)(),h=0;h<this.t;++h)s[h]=this.DM&~this[h];return s.t=this.t,s.s=~this.s,s}function te(s){var h=(0,t.nbi)();return s<0?this.rShiftTo(-s,h):this.lShiftTo(s,h),h}function ee(s){var h=(0,t.nbi)();return s<0?this.lShiftTo(-s,h):this.rShiftTo(s,h),h}function ie(s){if(s==0)return-1;var h=0;return s&65535||(s>>=16,h+=16),s&255||(s>>=8,h+=8),s&15||(s>>=4,h+=4),s&3||(s>>=2,h+=2),s&1||++h,h}function ne(){for(var s=0;s<this.t;++s)if(this[s]!=0)return s*this.DB+ie(this[s]);return this.s<0?this.t*this.DB:-1}function re(s){for(var h=0;s!=0;)s&=s-1,++h;return h}function se(){for(var s=0,h=this.s&this.DM,u=0;u<this.t;++u)s+=re(this[u]^h);return s}function oe(s){var h=Math.floor(s/this.DB);return h>=this.t?this.s!=0:(this[h]&1<<s%this.DB)!=0}function he(s,h){var u=t.BigInteger.ONE.shiftLeft(s);return this.bitwiseTo(u,h,u),u}function ae(s){return this.changeBit(s,N)}function ue(s){return this.changeBit(s,Mt)}function fe(s){return this.changeBit(s,Ot)}function le(s,h){for(var u=0,l=0,p=Math.min(s.t,this.t);u<p;)l+=this[u]+s[u],h[u++]=l&this.DM,l>>=this.DB;if(s.t<this.t){for(l+=s.s;u<this.t;)l+=this[u],h[u++]=l&this.DM,l>>=this.DB;l+=this.s}else{for(l+=this.s;u<s.t;)l+=s[u],h[u++]=l&this.DM,l>>=this.DB;l+=s.s}h.s=l<0?-1:0,l>0?h[u++]=l:l<-1&&(h[u++]=this.DV+l),h.t=u,h.clamp()}function ce(s){var h=(0,t.nbi)();return this.addTo(s,h),h}function pe(s){var h=(0,t.nbi)();return this.subTo(s,h),h}function ge(s){var h=(0,t.nbi)();return this.multiplyTo(s,h),h}function de(){var s=(0,t.nbi)();return this.squareTo(s),s}function ve(s){var h=(0,t.nbi)();return this.divRemTo(s,h,null),h}function ye(s){var h=(0,t.nbi)();return this.divRemTo(s,null,h),h}function be(s){var h=(0,t.nbi)(),u=(0,t.nbi)();return this.divRemTo(s,h,u),new Array(h,u)}function me(s){this[this.t]=this.am(0,s-1,this,0,0,this.t),++this.t,this.clamp()}function Se(s,h){if(s!=0){for(;this.t<=h;)this[this.t++]=0;for(this[h]+=s;this[h]>=this.DV;)this[h]-=this.DV,++h>=this.t&&(this[this.t++]=0),++this[h]}}function nt(){}function Vt(s){return s}function Te(s,h,u){s.multiplyTo(h,u)}function Be(s,h){s.squareTo(h)}nt.prototype.convert=Vt,nt.prototype.revert=Vt,nt.prototype.mulTo=Te,nt.prototype.sqrTo=Be;function xe(s){return this.exp(s,new nt)}function De(s,h,u){var l=Math.min(this.t+s.t,h);for(u.s=0,u.t=l;l>0;)u[--l]=0;var p;for(p=u.t-this.t;l<p;++l)u[l+this.t]=this.am(0,s[l],u,l,0,this.t);for(p=Math.min(s.t,h);l<p;++l)this.am(0,s[l],u,l,0,h-l);u.clamp()}function we(s,h,u){--h;var l=u.t=this.t+s.t-h;for(u.s=0;--l>=0;)u[l]=0;for(l=Math.max(h-this.t,0);l<s.t;++l)u[this.t+l-h]=this.am(h-l,s[l],u,0,0,this.t+l-h);u.clamp(),u.drShiftTo(1,u)}function z(s){this.r2=(0,t.nbi)(),this.q3=(0,t.nbi)(),t.BigInteger.ONE.dlShiftTo(2*s.t,this.r2),this.mu=this.r2.divide(s),this.m=s}function Ee(s){if(s.s<0||s.t>2*this.m.t)return s.mod(this.m);if(s.compareTo(this.m)<0)return s;var h=(0,t.nbi)();return s.copyTo(h),this.reduce(h),h}function Re(s){return s}function Ie(s){for(s.drShiftTo(this.m.t-1,this.r2),s.t>this.m.t+1&&(s.t=this.m.t+1,s.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);s.compareTo(this.r2)<0;)s.dAddOffset(1,this.m.t+1);for(s.subTo(this.r2,s);s.compareTo(this.m)>=0;)s.subTo(this.m,s)}function Ae(s,h){s.squareTo(h),this.reduce(h)}function Oe(s,h,u){s.multiplyTo(h,u),this.reduce(u)}z.prototype.convert=Ee,z.prototype.revert=Re,z.prototype.reduce=Ie,z.prototype.mulTo=Oe,z.prototype.sqrTo=Ae;function Me(s,h){var u=s.bitLength(),l,p=(0,t.nbv)(1),d;if(u<=0)return p;u<18?l=1:u<48?l=3:u<144?l=4:u<768?l=5:l=6,u<8?d=new t.Classic(h):h.isEven()?d=new z(h):d=new t.Montgomery(h);var S=[],b=3,U=l-1,Pt=(1<<l)-1;if(S[1]=d.convert(this),l>1){var _t=(0,t.nbi)();for(d.sqrTo(S[1],_t);b<=Pt;)S[b]=(0,t.nbi)(),d.mulTo(_t,S[b-2],S[b]),b+=2}var k=s.t-1,j,Ct=!0,H=(0,t.nbi)(),ft;for(u=(0,t.nbits)(s[k])-1;k>=0;){for(u>=U?j=s[k]>>u-U&Pt:(j=(s[k]&(1<<u+1)-1)<<U-u,k>0&&(j|=s[k-1]>>this.DB+u-U)),b=l;!(j&1);)j>>=1,--b;if((u-=b)<0&&(u+=this.DB,--k),Ct)S[j].copyTo(p),Ct=!1;else{for(;b>1;)d.sqrTo(p,H),d.sqrTo(H,p),b-=2;b>0?d.sqrTo(p,H):(ft=p,p=H,H=ft),d.mulTo(H,S[j],p)}for(;k>=0&&!(s[k]&1<<u);)d.sqrTo(p,H),ft=p,p=H,H=ft,--u<0&&(u=this.DB-1,--k)}return d.revert(p)}function Ve(s){var h=this.s<0?this.negate():this.clone(),u=s.s<0?s.negate():s.clone();if(h.compareTo(u)<0){var l=h;h=u,u=l}var p=h.getLowestSetBit(),d=u.getLowestSetBit();if(d<0)return h;for(p<d&&(d=p),d>0&&(h.rShiftTo(d,h),u.rShiftTo(d,u));h.signum()>0;)(p=h.getLowestSetBit())>0&&h.rShiftTo(p,h),(p=u.getLowestSetBit())>0&&u.rShiftTo(p,u),h.compareTo(u)>=0?(h.subTo(u,h),h.rShiftTo(1,h)):(u.subTo(h,u),u.rShiftTo(1,u));return d>0&&u.lShiftTo(d,u),u}function Pe(s){if(s<=0)return 0;var h=this.DV%s,u=this.s<0?s-1:0;if(this.t>0)if(h==0)u=this[0]%s;else for(var l=this.t-1;l>=0;--l)u=(h*u+this[l])%s;return u}function _e(s){var h=s.isEven();if(this.isEven()&&h||s.signum()==0)return t.BigInteger.ZERO;for(var u=s.clone(),l=this.clone(),p=(0,t.nbv)(1),d=(0,t.nbv)(0),S=(0,t.nbv)(0),b=(0,t.nbv)(1);u.signum()!=0;){for(;u.isEven();)u.rShiftTo(1,u),h?((!p.isEven()||!d.isEven())&&(p.addTo(this,p),d.subTo(s,d)),p.rShiftTo(1,p)):d.isEven()||d.subTo(s,d),d.rShiftTo(1,d);for(;l.isEven();)l.rShiftTo(1,l),h?((!S.isEven()||!b.isEven())&&(S.addTo(this,S),b.subTo(s,b)),S.rShiftTo(1,S)):b.isEven()||b.subTo(s,b),b.rShiftTo(1,b);u.compareTo(l)>=0?(u.subTo(l,u),h&&p.subTo(S,p),d.subTo(b,d)):(l.subTo(u,l),h&&S.subTo(p,S),b.subTo(d,b))}if(l.compareTo(t.BigInteger.ONE)!=0)return t.BigInteger.ZERO;if(b.compareTo(s)>=0)return b.subtract(s);if(b.signum()<0)b.addTo(s,b);else return b;return b.signum()<0?b.add(s):b}var A=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Ce=(1<<26)/A[A.length-1];function Ne(s){var h,u=this.abs();if(u.t==1&&u[0]<=A[A.length-1]){for(h=0;h<A.length;++h)if(u[0]==A[h])return!0;return!1}if(u.isEven())return!1;for(h=1;h<A.length;){for(var l=A[h],p=h+1;p<A.length&&l<Ce;)l*=A[p++];for(l=u.modInt(l);h<p;)if(l%A[h++]==0)return!1}return u.millerRabin(s)}function ke(s){var h=this.subtract(t.BigInteger.ONE),u=h.getLowestSetBit();if(u<=0)return!1;var l=h.shiftRight(u);s=s+1>>1,s>A.length&&(s=A.length);for(var p=(0,t.nbi)(),d=0;d<s;++d){p.fromInt(A[Math.floor(Math.random()*A.length)]);var S=p.modPow(l,this);if(S.compareTo(t.BigInteger.ONE)!=0&&S.compareTo(h)!=0){for(var b=1;b++<u&&S.compareTo(h)!=0;)if(S=S.modPowInt(2,this),S.compareTo(t.BigInteger.ONE)==0)return!1;if(S.compareTo(h)!=0)return!1}}return!0}t.BigInteger.prototype.chunkSize=f,t.BigInteger.prototype.toRadix=v,t.BigInteger.prototype.fromRadix=m,t.BigInteger.prototype.fromNumber=g,t.BigInteger.prototype.bitwiseTo=w,t.BigInteger.prototype.changeBit=he,t.BigInteger.prototype.addTo=le,t.BigInteger.prototype.dMultiply=me,t.BigInteger.prototype.dAddOffset=Se,t.BigInteger.prototype.multiplyLowerTo=De,t.BigInteger.prototype.multiplyUpperTo=we,t.BigInteger.prototype.modInt=Pe,t.BigInteger.prototype.millerRabin=ke,t.BigInteger.prototype.clone=i,t.BigInteger.prototype.intValue=n,t.BigInteger.prototype.byteValue=r,t.BigInteger.prototype.shortValue=o,t.BigInteger.prototype.signum=a,t.BigInteger.prototype.toByteArray=T,t.BigInteger.prototype.equals=B,t.BigInteger.prototype.min=D,t.BigInteger.prototype.max=R,t.BigInteger.prototype.and=I,t.BigInteger.prototype.or=Xt,t.BigInteger.prototype.xor=Yt,t.BigInteger.prototype.andNot=Wt,t.BigInteger.prototype.not=Qt,t.BigInteger.prototype.shiftLeft=te,t.BigInteger.prototype.shiftRight=ee,t.BigInteger.prototype.getLowestSetBit=ne,t.BigInteger.prototype.bitCount=se,t.BigInteger.prototype.testBit=oe,t.BigInteger.prototype.setBit=ae,t.BigInteger.prototype.clearBit=ue,t.BigInteger.prototype.flipBit=fe,t.BigInteger.prototype.add=ce,t.BigInteger.prototype.subtract=pe,t.BigInteger.prototype.multiply=ge,t.BigInteger.prototype.divide=ve,t.BigInteger.prototype.remainder=ye,t.BigInteger.prototype.divideAndRemainder=be,t.BigInteger.prototype.modPow=Me,t.BigInteger.prototype.modInverse=_e,t.BigInteger.prototype.pow=xe,t.BigInteger.prototype.gcd=Ve,t.BigInteger.prototype.isProbablePrime=Ne,t.BigInteger.prototype.square=de})(Tt);var ht={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.prng_newstate=Bi;function mi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var wt=at.Arcfour=function e(){mi(this,e),this.i=0,this.j=0,this.S=[]};function Si(e){var t,i,n;for(t=0;t<256;++t)this.S[t]=t;for(i=0,t=0;t<256;++t)i=i+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[i],this.S[i]=n;this.i=0,this.j=0}function Ti(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}wt.prototype.init=Si;wt.prototype.next=Ti;function Bi(){return new wt}at.rng_psize=256;Object.defineProperty(ht,"__esModule",{value:!0});ht.SecureRandom=void 0;var Nt=at;function xi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var lt,$,q;$==null&&($=new Array,q=0);function Di(){if(lt==null){for(lt=(0,Nt.prng_newstate)();q<Nt.rng_psize;){var e=Math.floor(65536*Math.random());$[q++]=e&255}for(lt.init($),q=0;q<$.length;++q)$[q]=0;q=0}return lt.next()}function wi(e){var t;for(t=0;t<e.length;++t)e[t]=Di()}var Ei=ht.SecureRandom=function e(){xi(this,e)};Ei.prototype.nextBytes=wi;Object.defineProperty(W,"__esModule",{value:!0});W.RSAKey=void 0;W.parseBigInt=jt;var Ut=Tt,Ri=ht;function Ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jt(e,t){return new Ut.BigInteger(e,t)}function Ai(e,t){if(t<e.length+11)return console.error("Message too long for RSA"),null;for(var i=[],n=e.length-1;n>=0&&t>0;){var r=e.charCodeAt(n--);r<128?i[--t]=r:r>127&&r<2048?(i[--t]=r&63|128,i[--t]=r>>6|192):(i[--t]=r&63|128,i[--t]=r>>6&63|128,i[--t]=r>>12|224)}i[--t]=0;for(var o=new Ri.SecureRandom,f=[];t>2;){for(f[0]=0;f[0]==0;)o.nextBytes(f);i[--t]=f[0]}return i[--t]=2,i[--t]=0,new Ut.BigInteger(i)}var Et=W.RSAKey=function e(){Ii(this,e),this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null};function Oi(e,t){e!=null&&t!=null&&e.length>0&&t.length>0?(this.n=jt(e,16),this.e=parseInt(t,16)):console.error("Invalid RSA public key")}function Mi(e){return e.modPowInt(this.e,this.n)}function Vi(e){var t=Ai(e,this.n.bitLength()+7>>3);if(t==null)return null;var i=this.doPublic(t);if(i==null)return null;var n=i.toString(16);return n.length&1?"0"+n:n}Et.prototype.doPublic=Mi;Et.prototype.setPublic=Oi;Et.prototype.encrypt=Vi;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.RSAKey=void 0;var t=W;Object.defineProperty(e,"RSAKey",{enumerable:!0,get:function(){return t.RSAKey}});var i=ht,n=M;function r(g,T){for(var B=g.toByteArray(),D=0;D<B.length&&B[D]==0;)++D;if(B.length-D!=T-1||B[D]!=2)return null;for(++D;B[D]!=0;)if(++D>=B.length)return null;for(var R="";++D<B.length;){var w=B[D]&255;w<128?R+=String.fromCharCode(w):w>191&&w<224?(R+=String.fromCharCode((w&31)<<6|B[D+1]&63),++D):(R+=String.fromCharCode((w&15)<<12|(B[D+1]&63)<<6|B[D+2]&63),D+=2)}return R}function o(g,T,B){g!=null&&T!=null&&g.length>0&&T.length>0?(this.n=(0,t.parseBigInt)(g,16),this.e=parseInt(T,16),this.d=(0,t.parseBigInt)(B,16)):console.error("Invalid RSA private key")}function f(g,T,B,D,R,w,P,I){g!=null&&T!=null&&g.length>0&&T.length>0?(this.n=(0,t.parseBigInt)(g,16),this.e=parseInt(T,16),this.d=(0,t.parseBigInt)(B,16),this.p=(0,t.parseBigInt)(D,16),this.q=(0,t.parseBigInt)(R,16),this.dmp1=(0,t.parseBigInt)(w,16),this.dmq1=(0,t.parseBigInt)(P,16),this.coeff=(0,t.parseBigInt)(I,16)):console.error("Invalid RSA private key")}function a(g,T){var B=new i.SecureRandom,D=g>>1;this.e=parseInt(T,16);for(var R=new n.BigInteger(T,16);;){for(;this.p=new n.BigInteger(g-D,1,B),!(this.p.subtract(n.BigInteger.ONE).gcd(R).compareTo(n.BigInteger.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new n.BigInteger(D,1,B),!(this.q.subtract(n.BigInteger.ONE).gcd(R).compareTo(n.BigInteger.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var w=this.p;this.p=this.q,this.q=w}var P=this.p.subtract(n.BigInteger.ONE),I=this.q.subtract(n.BigInteger.ONE),N=P.multiply(I);if(N.gcd(R).compareTo(n.BigInteger.ONE)==0){this.n=this.p.multiply(this.q),this.d=R.modInverse(N),this.dmp1=this.d.mod(P),this.dmq1=this.d.mod(I),this.coeff=this.q.modInverse(this.p);break}}}function v(g){if(this.p==null||this.q==null)return g.modPow(this.d,this.n);for(var T=g.mod(this.p).modPow(this.dmp1,this.p),B=g.mod(this.q).modPow(this.dmq1,this.q);T.compareTo(B)<0;)T=T.add(this.p);return T.subtract(B).multiply(this.coeff).mod(this.p).multiply(this.q).add(B)}function m(g){var T=(0,t.parseBigInt)(g,16),B=this.doPrivate(T);return B==null?null:r(B,this.n.bitLength()+7>>3)}t.RSAKey.prototype.doPrivate=v,t.RSAKey.prototype.setPrivate=o,t.RSAKey.prototype.setPrivateEx=f,t.RSAKey.prototype.generate=a,t.RSAKey.prototype.decrypt=m})(Lt);var Rt={};Object.defineProperty(Rt,"__esModule",{value:!0});var ot=Rt.Base64={},rt=void 0;ot.decode=function(e){var t;if(rt===void 0){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=`= \f
\r	 \u2028\u2029`;for(rt=[],t=0;t<64;++t)rt[i.charAt(t)]=t;for(t=0;t<n.length;++t)rt[n.charAt(t)]=-1}var r=[],o=0,f=0;for(t=0;t<e.length;++t){var a=e.charAt(t);if(a=="=")break;if(a=rt[a],a!=-1){if(a===void 0)throw"Illegal character at offset "+t;o|=a,++f>=4?(r[r.length]=o>>16,r[r.length]=o>>8&255,r[r.length]=o&255,o=0,f=0):o<<=6}}switch(f){case 1:throw"Base64 encoding incomplete: at least 2 bits missing";case 2:r[r.length]=o>>10;break;case 3:r[r.length]=o>>16,r[r.length]=o>>8&255;break}return r};ot.re=/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/;ot.unarmor=function(e){var t=ot.re.exec(e);if(t)if(t[1])e=t[1];else if(t[2])e=t[2];else throw"RegExp out of sync";return ot.decode(e)};var It={};Object.defineProperty(It,"__esModule",{value:!0});var Pi=It.Hex={},G=void 0;Pi.decode=function(e){var t;if(G===void 0){var i="0123456789ABCDEF",n=` \f
\r	 \u2028\u2029`;for(G=[],t=0;t<16;++t)G[i.charAt(t)]=t;for(i=i.toLowerCase(),t=10;t<16;++t)G[i.charAt(t)]=t;for(t=0;t<n.length;++t)G[n.charAt(t)]=-1}var r=[],o=0,f=0;for(t=0;t<e.length;++t){var a=e.charAt(t);if(a=="=")break;if(a=G[a],a!=-1){if(a===void 0)throw"Illegal character at offset "+t;o|=a,++f>=2?(r[r.length]=o,o=0,f=0):o<<=4}}if(f)throw"Hex encoding incomplete: 4 bits missing";return r};var Y={};Object.defineProperty(Y,"__esModule",{value:!0});Y.KJUR=Y.JSX=void 0;var pt=Tt;/*! asn1-1.0.2.js (c) 2013 Kenji Urushima | kjur.github.com/jsrsasign/license
 */var x=Y.JSX={};x.env=x.env||{};var bt=x,At=Object.prototype,_i="[object Function]",kt=["toString","valueOf"],Kt,Ci;x.env.parseUA=function(e){var t=function(m){var g=0;return parseFloat(m.replace(/\./g,function(){return g++==1?"":"."}))},i=Kt,n={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:i&&i.cajaVersion,secure:!1,os:null},r=e||Kt,o=Ci,f=o,a;return n.secure=f,r&&(/windows|win32/i.test(r)?n.os="windows":/macintosh/i.test(r)?n.os="macintosh":/rhino/i.test(r)&&(n.os="rhino"),/KHTML/.test(r)&&(n.webkit=1),a=r.match(/AppleWebKit\/([^\s]*)/),a&&a[1]&&(n.webkit=t(a[1]),/ Mobile\//.test(r)?(n.mobile="Apple",a=r.match(/OS ([^\s]*)/),a&&a[1]&&(a=t(a[1].replace("_","."))),n.ios=a,n.ipad=n.ipod=n.iphone=0,a=r.match(/iPad|iPod|iPhone/),a&&a[0]&&(n[a[0].toLowerCase()]=n.ios)):(a=r.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/),a&&(n.mobile=a[0]),/webOS/.test(r)&&(n.mobile="WebOS",a=r.match(/webOS\/([^\s]*);/),a&&a[1]&&(n.webos=t(a[1]))),/ Android/.test(r)&&(n.mobile="Android",a=r.match(/Android ([^\s]*);/),a&&a[1]&&(n.android=t(a[1])))),a=r.match(/Chrome\/([^\s]*)/),a&&a[1]?n.chrome=t(a[1]):(a=r.match(/AdobeAIR\/([^\s]*)/),a&&(n.air=a[0]))),n.webkit||(a=r.match(/Opera[\s\/]([^\s]*)/),a&&a[1]?(n.opera=t(a[1]),a=r.match(/Version\/([^\s]*)/),a&&a[1]&&(n.opera=t(a[1])),a=r.match(/Opera Mini[^;]*/),a&&(n.mobile=a[0])):(a=r.match(/MSIE\s([^;]*)/),a&&a[1]?n.ie=t(a[1]):(a=r.match(/Gecko\/([^\s]*)/),a&&(n.gecko=1,a=r.match(/rv:([^\s\)]*)/),a&&a[1]&&(n.gecko=t(a[1]))))))),n};x.env.ua=x.env.parseUA();x.isFunction=function(e){return typeof e=="function"||At.toString.apply(e)===_i};x._IEEnumFix=x.env.ua.ie?function(e,t){var i,n,r;for(i=0;i<kt.length;i=i+1)n=kt[i],r=t[n],bt.isFunction(r)&&r!=At[n]&&(e[n]=r)}:function(){};x.extend=function(e,t,i){if(!t||!e)throw new Error("extend failed, please check that all dependencies are included.");var n=function(){},r;if(n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==At.constructor&&(t.prototype.constructor=t),i){for(r in i)bt.hasOwnProperty(i,r)&&(e.prototype[r]=i[r]);bt._IEEnumFix(e.prototype,i)}};/**
 * @fileOverview
 * @name asn1-1.0.js
 * @author Kenji Urushima kenji.urushima@gmail.com
 * @version 1.0.2 (2013-May-30)
 * @since 2.1
 * @license <a href="http://kjur.github.io/jsrsasign/license/">MIT License</a>
 */var c=Y.KJUR={};(typeof c.asn1>"u"||!c.asn1)&&(c.asn1={});c.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if(t.substr(0,1)!="-")t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var i=t.substr(1),n=i.length;n%2==1?n+=1:t.match(/^[0-7]/)||(n+=2);for(var r="",o=0;o<n;o++)r+="f";var f=new pt.BigInteger(r,16),a=f.xor(e).add(pt.BigInteger.ONE);t=a.toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){var i=CryptoJS.enc.Hex.parse(e),n=CryptoJS.enc.Base64.stringify(i),r=n.replace(/(.{64})/g,`$1\r
`);return r=r.replace(/\r\n$/,""),"-----BEGIN "+t+`-----\r
`+r+`\r
-----END `+t+`-----\r
`}};c.asn1.ASN1Object=function(){var e="";this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+e.length+",v="+this.hV;var t=this.hV.length/2,i=t.toString(16);if(i.length%2==1&&(i="0"+i),t<128)return i;var n=i.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);var r=128+n;return r.toString(16)+i},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}};c.asn1.DERAbstractString=function(e){c.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"&&this.setStringHex(e.hex))};x.extend(c.asn1.DERAbstractString,c.asn1.ASN1Object);c.asn1.DERAbstractTime=function(e){c.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){utc=t.getTime()+t.getTimezoneOffset()*6e4;var i=new Date(utc);return i},this.formatDate=function(t,i){var n=this.zeroPadding,r=this.localDateToUTC(t),o=String(r.getFullYear());i=="utc"&&(o=o.substr(2,2));var f=n(String(r.getMonth()+1),2),a=n(String(r.getDate()),2),v=n(String(r.getHours()),2),m=n(String(r.getMinutes()),2),g=n(String(r.getSeconds()),2);return o+f+a+v+m+g+"Z"},this.zeroPadding=function(t,i){return t.length>=i?t:new Array(i-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setByDateValue=function(t,i,n,r,o,f){var a=new Date(Date.UTC(t,i-1,n,r,o,f,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}};x.extend(c.asn1.DERAbstractTime,c.asn1.ASN1Object);c.asn1.DERAbstractStructured=function(e){c.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,typeof e<"u"&&typeof e.array<"u"&&(this.asn1Array=e.array)};x.extend(c.asn1.DERAbstractStructured,c.asn1.ASN1Object);c.asn1.DERBoolean=function(){c.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"};x.extend(c.asn1.DERBoolean,c.asn1.ASN1Object);c.asn1.DERInteger=function(e){c.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=c.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var i=new pt.BigInteger(String(t),10);this.setByBigInteger(i)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.bigint<"u"?this.setByBigInteger(e.bigint):typeof e.int<"u"?this.setByInteger(e.int):typeof e.hex<"u"&&this.setValueHex(e.hex))};x.extend(c.asn1.DERInteger,c.asn1.ASN1Object);c.asn1.DERBitString=function(e){c.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,i){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+i},this.setByBinaryString=function(t){t=t.replace(/0+$/,"");var i=8-t.length%8;i==8&&(i=0);for(var n=0;n<=i;n++)t+="0";for(var r="",n=0;n<t.length-1;n+=8){var o=t.substr(n,8),f=parseInt(o,2).toString(16);f.length==1&&(f="0"+f),r+=f}this.hTLV=null,this.isModified=!0,this.hV="0"+i+r},this.setByBooleanArray=function(t){for(var i="",n=0;n<t.length;n++)t[n]==!0?i+="1":i+="0";this.setByBinaryString(i)},this.newFalseArray=function(t){for(var i=new Array(t),n=0;n<t;n++)i[n]=!1;return i},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.hex<"u"?this.setHexValueIncludingUnusedBits(e.hex):typeof e.bin<"u"?this.setByBinaryString(e.bin):typeof e.array<"u"&&this.setByBooleanArray(e.array))};x.extend(c.asn1.DERBitString,c.asn1.ASN1Object);c.asn1.DEROctetString=function(e){c.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"};x.extend(c.asn1.DEROctetString,c.asn1.DERAbstractString);c.asn1.DERNull=function(){c.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"};x.extend(c.asn1.DERNull,c.asn1.ASN1Object);c.asn1.DERObjectIdentifier=function(e){var t=function(r){var o=r.toString(16);return o.length==1&&(o="0"+o),o},i=function(r){var o="",f=new pt.BigInteger(r,10),a=f.toString(2),v=7-a.length%7;v==7&&(v=0);for(var m="",g=0;g<v;g++)m+="0";a=m+a;for(var g=0;g<a.length-1;g+=7){var T=a.substr(g,7);g!=a.length-7&&(T="1"+T),o+=t(parseInt(T,2))}return o};c.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(n){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueOidString=function(n){if(!n.match(/^[0-9.]+$/))throw"malformed oid string: "+n;var r="",o=n.split("."),f=parseInt(o[0])*40+parseInt(o[1]);r+=t(f),o.splice(0,2);for(var a=0;a<o.length;a++)r+=i(o[a]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(n){if(typeof c.asn1.x509.OID.name2oidList[n]<"u"){var r=c.asn1.x509.OID.name2oidList[n];this.setValueOidString(r)}else throw"DERObjectIdentifier oidName undefined: "+n},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.oid<"u"?this.setValueOidString(e.oid):typeof e.hex<"u"?this.setValueHex(e.hex):typeof e.name<"u"&&this.setValueName(e.name))};x.extend(c.asn1.DERObjectIdentifier,c.asn1.ASN1Object);c.asn1.DERUTF8String=function(e){c.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"};x.extend(c.asn1.DERUTF8String,c.asn1.DERAbstractString);c.asn1.DERNumericString=function(e){c.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"};x.extend(c.asn1.DERNumericString,c.asn1.DERAbstractString);c.asn1.DERPrintableString=function(e){c.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"};x.extend(c.asn1.DERPrintableString,c.asn1.DERAbstractString);c.asn1.DERTeletexString=function(e){c.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"};x.extend(c.asn1.DERTeletexString,c.asn1.DERAbstractString);c.asn1.DERIA5String=function(e){c.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"};x.extend(c.asn1.DERIA5String,c.asn1.DERAbstractString);c.asn1.DERUTCTime=function(e){c.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},typeof e<"u"&&(typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"?this.setStringHex(e.hex):typeof e.date<"u"&&this.setByDate(e.date))};x.extend(c.asn1.DERUTCTime,c.asn1.DERAbstractTime);c.asn1.DERGeneralizedTime=function(e){c.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen"),this.hV=stohex(this.s)},typeof e<"u"&&(typeof e.str<"u"?this.setString(e.str):typeof e.hex<"u"?this.setStringHex(e.hex):typeof e.date<"u"&&this.setByDate(e.date))};x.extend(c.asn1.DERGeneralizedTime,c.asn1.DERAbstractTime);c.asn1.DERSequence=function(e){c.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var t="",i=0;i<this.asn1Array.length;i++){var n=this.asn1Array[i];t+=n.getEncodedHex()}return this.hV=t,this.hV}};x.extend(c.asn1.DERSequence,c.asn1.DERAbstractStructured);c.asn1.DERSet=function(e){c.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.getFreshValueHex=function(){for(var t=new Array,i=0;i<this.asn1Array.length;i++){var n=this.asn1Array[i];t.push(n.getEncodedHex())}return t.sort(),this.hV=t.join(""),this.hV}};x.extend(c.asn1.DERSet,c.asn1.DERAbstractStructured);c.asn1.DERTaggedObject=function(e){c.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,i,n){this.hT=i,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,i),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},typeof e<"u"&&(typeof e.tag<"u"&&(this.hT=e.tag),typeof e.explicit<"u"&&(this.isExplicit=e.explicit),typeof e.obj<"u"&&(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))};x.extend(c.asn1.DERTaggedObject,c.asn1.ASN1Object);var ut={};Object.defineProperty(ut,"__esModule",{value:!0});ut.hex2b64=Ni;ut.b64tohex=zt;ut.b64toBA=ki;var J=M,Z="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Jt="=";function Ni(e){var t,i,n="";for(t=0;t+3<=e.length;t+=3)i=parseInt(e.substring(t,t+3),16),n+=Z.charAt(i>>6)+Z.charAt(i&63);for(t+1==e.length?(i=parseInt(e.substring(t,t+1),16),n+=Z.charAt(i<<2)):t+2==e.length&&(i=parseInt(e.substring(t,t+2),16),n+=Z.charAt(i>>2)+Z.charAt((i&3)<<4));(n.length&3)>0;)n+=Jt;return n}function zt(e){var t="",i,n=0,r;for(i=0;i<e.length&&e.charAt(i)!=Jt;++i){var o=Z.indexOf(e.charAt(i));o<0||(n==0?(t+=(0,J.int2char)(o>>2),r=o&3,n=1):n==1?(t+=(0,J.int2char)(r<<2|o>>4),r=o&15,n=2):n==2?(t+=(0,J.int2char)(r),t+=(0,J.int2char)(o>>2),r=o&3,n=3):(t+=(0,J.int2char)(r<<2|o>>4),t+=(0,J.int2char)(o&15),n=0))}return n==1&&(t+=(0,J.int2char)(r<<2)),t}function ki(e){var t=zt(e),i,n=[];for(i=0;2*i<t.length;++i)n[i]=parseInt(t.substring(2*i,2*i+2),16);return n}Object.defineProperty(mt,"__esModule",{value:!0});var Ki=mt.JSEncrypt=void 0,Gt=St,V=Lt,Fi=Rt,Hi=It,L=W,E=Y,vt=ut;function Zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Li(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:e}function qi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Gt.ASN1.prototype.getHexStringValue=function(){var e=this.toHexString(),t=this.header*2,i=this.length*2;return e.substr(t,i)};V.RSAKey.prototype.parseKey=function(e){try{var t=0,i=0,n=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,r=n.test(e)?Hi.Hex.decode(e):Fi.Base64.unarmor(e),o=Gt.ASN1.decode(r);if(o.sub.length===3&&(o=o.sub[2].sub[0]),o.sub.length===9){t=o.sub[1].getHexStringValue(),this.n=(0,L.parseBigInt)(t,16),i=o.sub[2].getHexStringValue(),this.e=parseInt(i,16);var f=o.sub[3].getHexStringValue();this.d=(0,L.parseBigInt)(f,16);var a=o.sub[4].getHexStringValue();this.p=(0,L.parseBigInt)(a,16);var v=o.sub[5].getHexStringValue();this.q=(0,L.parseBigInt)(v,16);var m=o.sub[6].getHexStringValue();this.dmp1=(0,L.parseBigInt)(m,16);var g=o.sub[7].getHexStringValue();this.dmq1=(0,L.parseBigInt)(g,16);var T=o.sub[8].getHexStringValue();this.coeff=(0,L.parseBigInt)(T,16)}else if(o.sub.length===2){var B=o.sub[1],D=B.sub[0];t=D.sub[0].getHexStringValue(),this.n=(0,L.parseBigInt)(t,16),i=D.sub[1].getHexStringValue(),this.e=parseInt(i,16)}else return!1;return!0}catch{return!1}};V.RSAKey.prototype.getPrivateBaseKey=function(){var e={array:[new E.KJUR.asn1.DERInteger({int:0}),new E.KJUR.asn1.DERInteger({bigint:this.n}),new E.KJUR.asn1.DERInteger({int:this.e}),new E.KJUR.asn1.DERInteger({bigint:this.d}),new E.KJUR.asn1.DERInteger({bigint:this.p}),new E.KJUR.asn1.DERInteger({bigint:this.q}),new E.KJUR.asn1.DERInteger({bigint:this.dmp1}),new E.KJUR.asn1.DERInteger({bigint:this.dmq1}),new E.KJUR.asn1.DERInteger({bigint:this.coeff})]},t=new E.KJUR.asn1.DERSequence(e);return t.getEncodedHex()};V.RSAKey.prototype.getPrivateBaseKeyB64=function(){return(0,vt.hex2b64)(this.getPrivateBaseKey())};V.RSAKey.prototype.getPublicBaseKey=function(){var e={array:[new E.KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new E.KJUR.asn1.DERNull]},t=new E.KJUR.asn1.DERSequence(e);e={array:[new E.KJUR.asn1.DERInteger({bigint:this.n}),new E.KJUR.asn1.DERInteger({int:this.e})]};var i=new E.KJUR.asn1.DERSequence(e);e={hex:"00"+i.getEncodedHex()};var n=new E.KJUR.asn1.DERBitString(e);e={array:[t,n]};var r=new E.KJUR.asn1.DERSequence(e);return r.getEncodedHex()};V.RSAKey.prototype.getPublicBaseKeyB64=function(){return(0,vt.hex2b64)(this.getPublicBaseKey())};V.RSAKey.prototype.wordwrap=function(e,t){if(t=t||64,!e)return e;var i="(.{1,"+t+`})( +|$
?)|(.{1,`+t+"})";return e.match(RegExp(i,"g")).join(`
`)};V.RSAKey.prototype.getPrivateKey=function(){var e=`-----BEGIN RSA PRIVATE KEY-----
`;return e+=this.wordwrap(this.getPrivateBaseKeyB64())+`
`,e+="-----END RSA PRIVATE KEY-----",e};V.RSAKey.prototype.getPublicKey=function(){var e=`-----BEGIN PUBLIC KEY-----
`;return e+=this.wordwrap(this.getPublicBaseKeyB64())+`
`,e+="-----END PUBLIC KEY-----",e};V.RSAKey.prototype.hasPublicKeyProperty=function(e){return e=e||{},e.hasOwnProperty("n")&&e.hasOwnProperty("e")};V.RSAKey.prototype.hasPrivateKeyProperty=function(e){return e=e||{},e.hasOwnProperty("n")&&e.hasOwnProperty("e")&&e.hasOwnProperty("d")&&e.hasOwnProperty("p")&&e.hasOwnProperty("q")&&e.hasOwnProperty("dmp1")&&e.hasOwnProperty("dmq1")&&e.hasOwnProperty("coeff")};V.RSAKey.prototype.parsePropertiesFrom=function(e){this.n=e.n,this.e=e.e,e.hasOwnProperty("d")&&(this.d=e.d,this.p=e.p,this.q=e.q,this.dmp1=e.dmp1,this.dmq1=e.dmq1,this.coeff=e.coeff)};var $t=function(e){qi(t,e);function t(i){Zt(this,t);var n=Li(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i&&(typeof i=="string"?n.parseKey(i):(n.hasPrivateKeyProperty(i)||n.hasPublicKeyProperty(i))&&n.parsePropertiesFrom(i)),n}return t}(V.RSAKey),F=Ki=mt.JSEncrypt=function e(t){Zt(this,e),t=t||{},this.default_key_size=parseInt(t.default_key_size)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null};F.prototype.setKey=function(e){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new $t(e)};F.prototype.setPrivateKey=function(e){this.setKey(e)};F.prototype.setPublicKey=function(e){this.setKey(e)};F.prototype.decrypt=function(e){try{return this.getKey().decrypt((0,vt.b64tohex)(e))}catch{return!1}};F.prototype.encrypt=function(e){try{return(0,vt.hex2b64)(this.getKey().encrypt(e))}catch{return!1}};F.prototype.getKey=function(e){if(!this.key){if(this.key=new $t,e&&{}.toString.call(e)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key};F.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()};F.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()};F.prototype.getPublicKey=function(){return this.getKey().getPublicKey()};F.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()};export{Ki as J};
