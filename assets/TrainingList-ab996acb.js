import{_ as z,__tla as Je}from"./request-cee48b27.js";import{a as R}from"./js-cookie-cf83ad76.js";import{u as qe}from"./vue-router-111722e5.js";import{_ as Pe,__tla as Fe}from"./_plugin-vue_export-helper-46758fc1.js";import{E as u,__tla as $e}from"./element-plus-e3bcbdc2.js";import{r as i,j as He,D as Re,ag as r,ar as De,o as T,c as Le,X as a,R as l,u as je,i as ie,F as Be,V as y,S as Ee,Q as q,U as Qe,a as c,W as x,ax as We,ay as Xe}from"./@vue-3b858b78.js";import"./axios-bff3f665.js";import"./nprogress-60a86a5b.js";import"./ali-oss-f05aeb17.js";import"./lodash-es-3b111273.js";import"./@vueuse-dbe79a15.js";import"./@element-plus-ffae287f.js";import"./@popperjs-c45de710.js";import"./@ctrl-43a4208a.js";import"./dayjs-de8721ee.js";import"./async-validator-7f96df71.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import{__tla as Ae}from"./@floating-ui-dec9075e.js";let ue,Ge=Promise.all([(()=>{try{return Je}catch{}})(),(()=>{try{return Fe}catch{}})(),(()=>{try{return $e}catch{}})(),(()=>{try{return Ae}catch{}})()]).then(async()=>{let U,D,L,j,B,E,Q,W,X,A;U=N=>(We("data-v-cf150923"),N=N(),Xe(),N),D={class:"dialog-footer"},L={class:"trainingBody"},j={style:{"font-size":"2em"}},B=U(()=>c("p",null,null,-1)),E=U(()=>c("span",{style:{"font-size":"1em"}},"\u5F53\u524D\u6A21\u62DF\u65F6\u957F",-1)),Q=U(()=>c("p",null,null,-1)),W={style:{"font-size":"3em"}},X={class:"dialog-footer"},A={__name:"TrainingList",setup(N){qe();const h=i([]),P=i(!1),s=i({query:"",pageNum:1,pageSize:5}),oe=i(),G=i(0),se=(n,e,o)=>o?o.length>20?o.slice(0,20)+"...":o:"",C=async()=>{try{P.value=!0;const{data:n}=await z.get("/backstage-management-service/model",{params:{query:s.value.query,pageNum:s.value.pageNum,pageSize:s.value.pageSize}});n.code!==2e3?u.error(n.msg):(h.value=n.data.list,h.value.sort((e,o)=>e.priority-o.priority),G.value=n.data.total)}catch{u.error("\u83B7\u53D6\u6A21\u62DF\u573A\u666F\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{P.value=!1}},de=n=>{s.pageSize=n,C()},ce=()=>{s.pageNum=newPage,C()};let p=i(!1);const d=i({name:"",description:"",enable:!0,priority:0}),K=i(),pe=n=>{p.value=!0;const e=h.value.find(o=>o.id===n);d.value={name:e.name,description:e.description,enable:e.enable,priority:e.priority}},me=()=>{p.value=!1,K.value.resetFields()},g=i(0),Y=i(""),b=i(!1),S=i(0),m=i(0),v=i(0),w=i(0),ve=async n=>{try{const{data:e}=await z.post(`/backstage-management-service/training/${n}`);if(e.code!==2e3)u.error(e.msg);else{g.value=e.data;const o={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value};window.localStorage.setItem("trainingStatus",JSON.stringify(o)),Y.value=h.value.find(F=>F.id===n).name,b.value=!0,ee(),u.success("\u542F\u52A8\u6A21\u62DF\u6210\u529F")}}catch{u.error("\u542F\u52A8\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}};let Z=null;const ee=()=>{Z=setInterval(()=>{w.value+=10,w.value>=1e3&&(w.value=0,v.value+=1),v.value>=60&&(v.value=0,m.value+=1),m.value>=60&&(m.value=0,S.value+=1)},10)},V=i(!1),k=i(!1),ae=async()=>{try{k.value=!0,V.value?ee():le(),V.value=!V.value;const n={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value,currentTrainingMillisecond:w.value,currentTrainingSecond:v.value,currentTrainingMinute:m.value,currentTrainingHour:S.value};window.localStorage.setItem("trainingStatus",JSON.stringify(n));const{data:e}=await z.put(`/backstage-management-service/training/${g.value}`);e.code!==2e3?u.error(e.msg):V.value?u.success("\u6682\u505C\u6A21\u62DF\u6210\u529F"):u.success("\u7EE7\u7EED\u6A21\u62DF\u6210\u529F")}catch{u.error("\u6682\u505C/\u7EE7\u7EED\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{k.value=!1}},le=()=>{clearInterval(Z)},M=i(!1),ge=async()=>{M.value=!0;try{const{data:n}=await z.get(`/backstage-management-service/training/${g.value}`);n.code!==2e3?u.error(n.msg):(window.localStorage.removeItem("trainingStatus"),b.value=!1,S.value=0,m.value=0,v.value=0,u.success("\u7ED3\u675F\u6A21\u62DF\u6210\u529F, \u8BF7\u5728\u6A21\u62DF\u8BB0\u5F55\u4E2D\u67E5\u770B\u6A21\u62DF\u7ED3\u679C"))}catch{u.error("\u7ED3\u675F\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{M.value=!1}},O=i(!1),fe=async()=>{O.value=!0;try{const{data:n}=await z.delete(`/backstage-management-service/training/${g.value}`);n.code!==2e3?u.error(n.msg):(window.localStorage.removeItem("trainingStatus"),b.value=!1,S.value=0,m.value=0,v.value=0,u.success("\u53D6\u6D88\u6A21\u62DF\u6210\u529F, \u8BF7\u5728\u6A21\u62DF\u8BB0\u5F55\u4E2D\u67E5\u770B\u6A21\u62DF\u7ED3\u679C"))}catch{u.error("\u53D6\u6D88\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{O.value=!1}};return He(()=>{if(C(),window.localStorage.getItem("trainingStatus")!==null){const n=JSON.parse(window.localStorage.getItem("trainingStatus"));w.value=n.currentTrainingMillisecond,v.value=n.currentTrainingSecond,m.value=n.currentTrainingMinute,S.value=n.currentTrainingHour,g.value=n.currentTrainingId,b.value=!0,V.value=!0}}),Re(()=>{if(b.value){le();const n={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value,currentTrainingMillisecond:w.value,currentTrainingSecond:v.value,currentTrainingMinute:m.value,currentTrainingHour:S.value};window.localStorage.setItem("trainingStatus",JSON.stringify(n))}}),(n,e)=>{const o=r("el-breadcrumb-item"),F=r("el-breadcrumb"),_e=r("Search"),f=r("el-icon"),_=r("el-button"),$=r("el-input"),ye=r("el-col"),be=r("el-row"),Se=r("el-empty"),I=r("el-table-column"),te=r("el-switch"),we=r("InfoFilled"),ne=r("el-tooltip"),he=r("Opportunity"),Ve=r("el-table"),ke=r("el-pagination"),Ie=r("el-card"),Ce=r("Menu"),J=r("el-form-item"),ze=r("el-input-number"),Te=r("el-form"),re=r("el-dialog"),xe=r("CircleClose"),Ue=r("VideoPause"),Ne=r("VideoPlay"),Me=r("CircleCheck"),Oe=De("loading");return T(),Le(Be,null,[a(F,null,{default:l(()=>[a(o,{to:{path:"/police/home"}},{default:l(()=>[y("\u9996\u9875")]),_:1}),a(o,null,{default:l(()=>[y("\u6A21\u62DF\u573A\u666F\u9009\u62E9")]),_:1})]),_:1}),a(Ie,{style:{"margin-top":"2%"}},{default:l(()=>[a(be,{class:"searchRow"},{default:l(()=>[a(ye,{span:10},{default:l(()=>[a($,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9",modelValue:s.value.query,"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.query=t),clearable:"",onClear:e[2]||(e[2]=t=>C())},{append:l(()=>[a(_,{onClick:e[0]||(e[0]=t=>C())},{default:l(()=>[a(f,{class:"el-input__icon"},{default:l(()=>[a(_e)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),Ee((T(),q(Ve,{style:{width:"100%"},ref:oe.value,data:h.value,border:"",stripe:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"}},{default:l(()=>[h.value.length===0?(T(),q(Se,{key:0,description:"\u6682\u65E0\u6570\u636E"})):Qe("",!0),a(I,{prop:"id",label:"ID"}),a(I,{prop:"name",label:"\u573A\u666F\u540D\u79F0"}),a(I,{label:"\u662F\u5426\u542F\u7528"},{default:l(t=>[a(te,{modelValue:t.row.enable,"onUpdate:modelValue":H=>t.row.enable=H,"inline-prompt":"","active-text":"\u542F\u7528","inactive-text":"\u7981\u7528",disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(I,{prop:"priority",label:"\u4F18\u5148\u7EA7"}),a(I,{prop:"description",label:"\u63CF\u8FF0",formatter:se}),a(I,{label:"\u64CD\u4F5C"},{default:l(t=>[a(ne,{effect:"light",content:"\u67E5\u770B\u573A\u666F\u5177\u4F53\u4FE1\u606F",placement:"top",enterable:!1},{default:l(()=>[a(_,{type:"success",circle:"",size:"small",onClick:H=>pe(t.row.id)},{default:l(()=>[a(f,null,{default:l(()=>[a(we)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),a(_,{type:"primary",size:"small",onClick:H=>ve(t.row.id)},{default:l(()=>[a(f,null,{default:l(()=>[a(he)]),_:1}),y(" \u5F00\u59CB\u6A21\u62DF ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Oe,P.value]]),a(ke,{"current-page":s.value.pageNum,"onUpdate:currentPage":e[3]||(e[3]=t=>s.value.pageNum=t),"page-size":s.value.pageSize,"onUpdate:pageSize":e[4]||(e[4]=t=>s.value.pageSize=t),"page-sizes":[2,5,10,20],layout:"total, sizes, prev, pager, next, jumper",total:G.value,onSizeChange:e[5]||(e[5]=t=>de()),onCurrentChange:e[6]||(e[6]=t=>ce())},null,8,["current-page","page-size","total"])]),_:1}),a(re,{title:"\u573A\u666F\u4FE1\u606F",modelValue:je(p),"onUpdate:modelValue":e[12]||(e[12]=t=>ie(p)?p.value=t:p=t),center:"","before-close":me},{footer:l(()=>[c("span",D,[a(_,{onClick:e[11]||(e[11]=t=>ie(p)?p.value=!1:p=!1)},{default:l(()=>[y("\u5173\u95ED")]),_:1})])]),default:l(()=>[a(Te,{model:d.value,ref_key:"checkModelFormRef",ref:K,disabled:!0},{default:l(()=>[a(J,{label:"\u573A\u666F\u540D\u79F0"},{default:l(()=>[a($,{modelValue:d.value.name,"onUpdate:modelValue":e[7]||(e[7]=t=>d.value.name=t),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0"},{prefix:l(()=>[a(f,null,{default:l(()=>[a(Ce)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(J,{label:"\u662F\u5426\u542F\u7528"},{default:l(()=>[a(te,{modelValue:d.value.enable,"onUpdate:modelValue":e[8]||(e[8]=t=>d.value.enable=t),"inline-prompt":"","active-text":"\u542F\u7528","inactive-text":"\u7981\u7528"},null,8,["modelValue"])]),_:1}),a(J,{label:"\u4F18\u5148\u7EA7\u522B"},{default:l(()=>[a(ne,{effect:"light",content:"\u6570\u5B57\u8D8A\u5C0F(-65525~65535),\u4F18\u5148\u7EA7\u8D8A\u9AD8",placement:"bottom"},{default:l(()=>[a(ze,{modelValue:d.value.priority,"onUpdate:modelValue":e[9]||(e[9]=t=>d.value.priority=t),min:-65535,max:65535,step:1},null,8,["modelValue"])]),_:1})]),_:1}),a(J,{label:"\u573A\u666F\u63CF\u8FF0"},{default:l(()=>[a($,{type:"textarea",maxlength:"255",rows:"5",modelValue:d.value.description,"onUpdate:modelValue":e[10]||(e[10]=t=>d.value.description=t),"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(re,{center:"",modelValue:b.value,"onUpdate:modelValue":e[17]||(e[17]=t=>b.value=t),"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},{footer:l(()=>[c("span",X,[a(_,{type:"danger",loading:O.value,disabled:O.value,onClick:e[13]||(e[13]=t=>fe())},{default:l(()=>[a(f,null,{default:l(()=>[a(xe)]),_:1}),y(" \u53D6\u6D88\u6A21\u62DF ")]),_:1},8,["loading","disabled"]),V.value?(T(),q(_,{key:1,type:"success",loading:k.value,disabled:k.value,onClick:e[15]||(e[15]=t=>ae())},{default:l(()=>[a(f,null,{default:l(()=>[a(Ne)]),_:1}),y(" \u7EE7\u7EED\u6A21\u62DF ")]),_:1},8,["loading","disabled"])):(T(),q(_,{key:0,type:"warning",loading:k.value,disabled:k.value,onClick:e[14]||(e[14]=t=>ae())},{default:l(()=>[a(f,null,{default:l(()=>[a(Ue)]),_:1}),y(" \u6682\u505C\u6A21\u62DF ")]),_:1},8,["loading","disabled"])),a(_,{type:"primary",loading:M.value,onClick:e[16]||(e[16]=t=>ge()),disabled:M.value},{default:l(()=>[a(f,null,{default:l(()=>[a(Me)]),_:1}),y(" \u7ED3\u675F\u6A21\u62DF ")]),_:1},8,["loading","disabled"])])]),default:l(()=>[c("div",L,[c("div",null,[c("span",j,"\u60A8\u6B63\u5728\u8FDB\u884C\u573A\u666F "+x(Y.value)+" \u7684\u6A21\u62DF",1)]),B,c("div",null,[E,Q,c("span",W,x(S.value)+":"+x(m.value)+":"+x(v.value)+":"+x(w.value.toString().substring(0,2)),1)])])]),_:1},8,["modelValue"])],64)}}},ue=Pe(A,[["__scopeId","data-v-cf150923"]])});export{Ge as __tla,ue as default};
