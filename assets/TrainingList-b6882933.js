import{_ as T,__tla as Oe}from"./request-876a3898.js";import{a as R}from"./js-cookie-cf83ad76.js";import{u as qe}from"./vue-router-111722e5.js";import{_ as Fe,__tla as Pe}from"./_plugin-vue_export-helper-12fdbf0b.js";import{E as u,__tla as $e}from"./element-plus-d18cd086.js";import{r as i,j as He,D as Re,ag as n,ar as De,o as z,c as je,X as e,R as a,u as Be,i as ie,F as Ee,V as y,S as Le,Q as q,U as Qe,a as c,W as x,ax as We,ay as Xe}from"./@vue-3b858b78.js";import"./axios-bff3f665.js";import"./nprogress-beeea432.js";import"./ali-oss-3fdf9ab6.js";import"./lodash-es-3b111273.js";import"./@vueuse-dbe79a15.js";import"./@element-plus-ffae287f.js";import"./@popperjs-c45de710.js";import"./@ctrl-43a4208a.js";import"./dayjs-47c5195e.js";import"./async-validator-7f96df71.js";import"./memoize-one-297ddbcb.js";import"./escape-html-1d60d822.js";import"./normalize-wheel-es-ed76fb12.js";import{__tla as Ae}from"./@floating-ui-dec9075e.js";let ue,Ge=Promise.all([(()=>{try{return Oe}catch{}})(),(()=>{try{return Pe}catch{}})(),(()=>{try{return $e}catch{}})(),(()=>{try{return Ae}catch{}})()]).then(async()=>{let N,D,j,B,E,L,Q,W,X,A;N=U=>(We("data-v-df184310"),U=U(),Xe(),U),D={class:"dialog-footer"},j={class:"trainingBody"},B={style:{"font-size":"2em"}},E=N(()=>c("p",null,null,-1)),L=N(()=>c("span",{style:{"font-size":"1em"}},"\u5F53\u524D\u6A21\u62DF\u65F6\u957F",-1)),Q=N(()=>c("p",null,null,-1)),W={style:{"font-size":"3em"}},X={class:"dialog-footer"},A={__name:"TrainingList",setup(U){qe();const h=i([]),F=i(!1),s=i({query:"",pageNum:1,pageSize:5}),oe=i(),G=i(0),se=(t,l,o)=>o?o.length>20?o.slice(0,20)+"...":o:"",C=async()=>{try{F.value=!0;const{data:t}=await T.get("/backstage-management-service/model",{params:{query:s.value.query,pageNum:s.value.pageNum,pageSize:s.value.pageSize}});t.code!==2e3?u.error(t.msg):(h.value=t.data.list,h.value.sort((l,o)=>l.priority-o.priority),G.value=t.data.total)}catch{u.error("\u83B7\u53D6\u6A21\u62DF\u573A\u666F\u5217\u8868\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{F.value=!1}},de=t=>{s.pageSize=t,C()},ce=t=>{s.pageNum=t,C()};let p=i(!1);const d=i({name:"",description:"",enable:!0,priority:0}),K=i(),pe=t=>{p.value=!0;const l=h.value.find(o=>o.id===t);d.value={name:l.name,description:l.description,enable:l.enable,priority:l.priority}},me=()=>{p.value=!1,K.value.resetFields()},g=i(0),Y=i(""),b=i(!1),S=i(0),m=i(0),v=i(0),w=i(0),ve=async t=>{try{const{data:l}=await T.post(`/backstage-management-service/training/${t}`);if(l.code!==2e3)u.error(l.msg);else{g.value=l.data;const o={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value};window.localStorage.setItem("trainingStatus",JSON.stringify(o)),Y.value=h.value.find(P=>P.id===t).name,b.value=!0,ee(),u.success("\u542F\u52A8\u6A21\u62DF\u6210\u529F")}}catch{u.error("\u542F\u52A8\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}};let Z=null;const ee=()=>{Z=setInterval(()=>{w.value+=10,w.value>=1e3&&(w.value=0,v.value+=1),v.value>=60&&(v.value=0,m.value+=1),m.value>=60&&(m.value=0,S.value+=1)},10)},V=i(!1),k=i(!1),ae=async()=>{try{k.value=!0,V.value?ee():le(),V.value=!V.value;const t={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value,currentTrainingMillisecond:w.value,currentTrainingSecond:v.value,currentTrainingMinute:m.value,currentTrainingHour:S.value};window.localStorage.setItem("trainingStatus",JSON.stringify(t));const{data:l}=await T.put(`/backstage-management-service/training/${g.value}`);l.code!==2e3?u.error(l.msg):V.value?u.success("\u6682\u505C\u6A21\u62DF\u6210\u529F"):u.success("\u7EE7\u7EED\u6A21\u62DF\u6210\u529F")}catch{u.error("\u6682\u505C/\u7EE7\u7EED\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{k.value=!1}},le=()=>{clearInterval(Z)},J=i(!1),ge=async()=>{J.value=!0;try{const{data:t}=await T.get(`/backstage-management-service/training/${g.value}`);t.code!==2e3?u.error(t.msg):(window.localStorage.removeItem("trainingStatus"),b.value=!1,S.value=0,m.value=0,v.value=0,u.success("\u7ED3\u675F\u6A21\u62DF\u6210\u529F, \u8BF7\u5728\u6A21\u62DF\u8BB0\u5F55\u4E2D\u67E5\u770B\u6A21\u62DF\u7ED3\u679C"))}catch{u.error("\u7ED3\u675F\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{J.value=!1}},M=i(!1),fe=async()=>{M.value=!0;try{const{data:t}=await T.delete(`/backstage-management-service/training/${g.value}`);t.code!==2e3?u.error(t.msg):(window.localStorage.removeItem("trainingStatus"),b.value=!1,S.value=0,m.value=0,v.value=0,u.success("\u53D6\u6D88\u6A21\u62DF\u6210\u529F, \u8BF7\u5728\u6A21\u62DF\u8BB0\u5F55\u4E2D\u67E5\u770B\u6A21\u62DF\u7ED3\u679C"))}catch{u.error("\u53D6\u6D88\u6A21\u62DF\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u73AF\u5883")}finally{M.value=!1}};return He(()=>{if(C(),window.localStorage.getItem("trainingStatus")!==null){const t=JSON.parse(window.localStorage.getItem("trainingStatus"));w.value=t.currentTrainingMillisecond,v.value=t.currentTrainingSecond,m.value=t.currentTrainingMinute,S.value=t.currentTrainingHour,g.value=t.currentTrainingId,b.value=!0,V.value=!0}}),Re(()=>{if(b.value){le();const t={policeId:JSON.parse(R.get("person")).id,currentTrainingId:g.value,currentTrainingMillisecond:w.value,currentTrainingSecond:v.value,currentTrainingMinute:m.value,currentTrainingHour:S.value};window.localStorage.setItem("trainingStatus",JSON.stringify(t))}}),(t,l)=>{const o=n("el-breadcrumb-item"),P=n("el-breadcrumb"),_e=n("Search"),f=n("el-icon"),_=n("el-button"),$=n("el-input"),ye=n("el-col"),be=n("el-row"),Se=n("el-empty"),I=n("el-table-column"),te=n("el-switch"),we=n("InfoFilled"),ne=n("el-tooltip"),he=n("Opportunity"),Ve=n("el-table"),ke=n("el-pagination"),Ie=n("el-card"),Ce=n("Menu"),O=n("el-form-item"),Te=n("el-input-number"),ze=n("el-form"),re=n("el-dialog"),xe=n("CircleClose"),Ne=n("VideoPause"),Ue=n("VideoPlay"),Je=n("CircleCheck"),Me=De("loading");return z(),je(Ee,null,[e(P,null,{default:a(()=>[e(o,{to:{path:"/police/home"}},{default:a(()=>[y("\u9996\u9875")]),_:1}),e(o,null,{default:a(()=>[y("\u6A21\u62DF\u573A\u666F\u9009\u62E9")]),_:1})]),_:1}),e(Ie,{style:{"margin-top":"2%"}},{default:a(()=>[e(be,{class:"searchRow"},{default:a(()=>[e(ye,{span:10},{default:a(()=>[e($,{placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9",modelValue:s.value.query,"onUpdate:modelValue":l[0]||(l[0]=r=>s.value.query=r),clearable:"",onClear:C},{append:a(()=>[e(_,{onClick:C},{default:a(()=>[e(f,{class:"el-input__icon"},{default:a(()=>[e(_e)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),Le((z(),q(Ve,{style:{width:"100%"},ref:oe.value,data:h.value,border:"",stripe:"","header-cell-style":{"text-align":"center"},"cell-style":{"text-align":"center"}},{default:a(()=>[h.value.length===0?(z(),q(Se,{key:0,description:"\u6682\u65E0\u6570\u636E"})):Qe("",!0),e(I,{prop:"id",label:"ID"}),e(I,{prop:"name",label:"\u573A\u666F\u540D\u79F0"}),e(I,{label:"\u662F\u5426\u542F\u7528"},{default:a(r=>[e(te,{modelValue:r.row.enable,"onUpdate:modelValue":H=>r.row.enable=H,"inline-prompt":"","active-text":"\u542F\u7528","inactive-text":"\u7981\u7528",disabled:!0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(I,{prop:"priority",label:"\u4F18\u5148\u7EA7"}),e(I,{prop:"description",label:"\u63CF\u8FF0",formatter:se}),e(I,{label:"\u64CD\u4F5C"},{default:a(r=>[e(ne,{effect:"light",content:"\u67E5\u770B\u573A\u666F\u5177\u4F53\u4FE1\u606F",placement:"top",enterable:!1},{default:a(()=>[e(_,{type:"success",circle:"",size:"small",onClick:H=>pe(r.row.id)},{default:a(()=>[e(f,null,{default:a(()=>[e(we)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024),e(_,{type:"primary",size:"small",onClick:H=>ve(r.row.id)},{default:a(()=>[e(f,null,{default:a(()=>[e(he)]),_:1}),y(" \u5F00\u59CB\u6A21\u62DF ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Me,F.value]]),e(ke,{"current-page":s.value.pageNum,"onUpdate:currentPage":l[1]||(l[1]=r=>s.value.pageNum=r),"page-size":s.value.pageSize,"onUpdate:pageSize":l[2]||(l[2]=r=>s.value.pageSize=r),"page-sizes":[2,5,10,20],layout:"total, sizes, prev, pager, next, jumper",total:G.value,onSizeChange:de,onCurrentChange:ce},null,8,["current-page","page-size","total"])]),_:1}),e(re,{title:"\u573A\u666F\u4FE1\u606F",modelValue:Be(p),"onUpdate:modelValue":l[8]||(l[8]=r=>ie(p)?p.value=r:p=r),center:"","before-close":me},{footer:a(()=>[c("span",D,[e(_,{onClick:l[7]||(l[7]=r=>ie(p)?p.value=!1:p=!1)},{default:a(()=>[y("\u5173\u95ED")]),_:1})])]),default:a(()=>[e(ze,{model:d.value,ref_key:"checkModelFormRef",ref:K,disabled:!0},{default:a(()=>[e(O,{label:"\u573A\u666F\u540D\u79F0"},{default:a(()=>[e($,{modelValue:d.value.name,"onUpdate:modelValue":l[3]||(l[3]=r=>d.value.name=r),placeholder:"\u8BF7\u8F93\u5165\u573A\u666F\u540D\u79F0"},{prefix:a(()=>[e(f,null,{default:a(()=>[e(Ce)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(O,{label:"\u662F\u5426\u542F\u7528"},{default:a(()=>[e(te,{modelValue:d.value.enable,"onUpdate:modelValue":l[4]||(l[4]=r=>d.value.enable=r),"inline-prompt":"","active-text":"\u542F\u7528","inactive-text":"\u7981\u7528"},null,8,["modelValue"])]),_:1}),e(O,{label:"\u4F18\u5148\u7EA7\u522B"},{default:a(()=>[e(ne,{effect:"light",content:"\u6570\u5B57\u8D8A\u5C0F(-65525~65535),\u4F18\u5148\u7EA7\u8D8A\u9AD8",placement:"bottom"},{default:a(()=>[e(Te,{modelValue:d.value.priority,"onUpdate:modelValue":l[5]||(l[5]=r=>d.value.priority=r),min:-65535,max:65535,step:1},null,8,["modelValue"])]),_:1})]),_:1}),e(O,{label:"\u573A\u666F\u63CF\u8FF0"},{default:a(()=>[e($,{type:"textarea",maxlength:"255",rows:"5",modelValue:d.value.description,"onUpdate:modelValue":l[6]||(l[6]=r=>d.value.description=r),"show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(re,{center:"",modelValue:b.value,"onUpdate:modelValue":l[9]||(l[9]=r=>b.value=r),"close-on-press-escape":!1,"close-on-click-modal":!1,"show-close":!1},{footer:a(()=>[c("span",X,[e(_,{type:"danger",loading:M.value,disabled:M.value,onClick:fe},{default:a(()=>[e(f,null,{default:a(()=>[e(xe)]),_:1}),y(" \u53D6\u6D88\u6A21\u62DF ")]),_:1},8,["loading","disabled"]),V.value?(z(),q(_,{key:1,type:"success",loading:k.value,disabled:k.value,onClick:ae},{default:a(()=>[e(f,null,{default:a(()=>[e(Ue)]),_:1}),y(" \u7EE7\u7EED\u6A21\u62DF ")]),_:1},8,["loading","disabled"])):(z(),q(_,{key:0,type:"warning",loading:k.value,disabled:k.value,onClick:ae},{default:a(()=>[e(f,null,{default:a(()=>[e(Ne)]),_:1}),y(" \u6682\u505C\u6A21\u62DF ")]),_:1},8,["loading","disabled"])),e(_,{type:"primary",loading:J.value,onClick:ge,disabled:J.value},{default:a(()=>[e(f,null,{default:a(()=>[e(Je)]),_:1}),y(" \u7ED3\u675F\u6A21\u62DF ")]),_:1},8,["loading","disabled"])])]),default:a(()=>[c("div",j,[c("div",null,[c("span",B,"\u60A8\u6B63\u5728\u8FDB\u884C\u573A\u666F "+x(Y.value)+" \u7684\u6A21\u62DF",1)]),E,c("div",null,[L,Q,c("span",W,x(S.value)+":"+x(m.value)+":"+x(v.value)+":"+x(w.value.toString().substring(0,2)),1)])])]),_:1},8,["modelValue"])],64)}}},ue=Fe(A,[["__scopeId","data-v-df184310"]])});export{Ge as __tla,ue as default};
